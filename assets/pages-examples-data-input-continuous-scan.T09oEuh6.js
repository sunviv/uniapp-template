import{d as e,B as a,r as t,g as l,w as s,m as o,o as u,C as i,a as n,b as r,e as c,f as d,i as f,l as p,h as v,G as m,n as _,v as h,a5 as w,a1 as b,aa as x,ab as g,a6 as y,x as k,y as C,u as j,p as V,F as $,E as T,k as Q,t as F,I}from"./index-CNS4YNQM.js";import{B as z,_ as M}from"./index.BUZRRMO1.js";import{_ as O}from"./wd-navbar.BXFrT7IQ.js";import{_ as P}from"./wd-status-tip.DxI_4-EF.js";import{q,p as B,r as G,c as S}from"./useQueue.DoCAt2WZ.js";import{u as A}from"./useTouch.DabG_it2.js";import{c as D,a as E,b as H,g as L}from"./wd-icon.BUBiR9XW.js";import{_ as X}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as J}from"./wd-button.BoDnO6vG.js";const K=X(e({name:"wd-swipe-action",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...D,modelValue:H("close"),disabled:E(!1),beforeClose:Function},emits:["click","update:modelValue"],setup(e,{expose:h,emit:w}){const b=e,x=w,g=a(q,null),y=t(""),k=t(0),C=t(0),j=t(!1),V=A(),{proxy:$}=l();function T(e,a){b.disabled||Q().then(([t,l])=>{switch(e){case"close":if(0===C.value)return;P("value",a);break;case"left":F(t);break;case"right":F(-l)}})}function Q(){return Promise.all([L(".wd-swipe-action__left",!1,$).then(e=>e.width?e.width:0),L(".wd-swipe-action__right",!1,$).then(e=>e.width?e.width:0)])}function F(e=0){const a=`translate3d(${e}px, 0, 0)`,t=j.value?"none":".6s cubic-bezier(0.18, 0.89, 0.32, 1)";y.value=`\n        -webkit-transform: ${a};\n        -webkit-transition: ${t};\n        transform: ${a};\n        transition: ${t};\n      `,C.value=e}function I(e){b.disabled||0===C.value||(P("click",e=e||"inside"),x("click",{value:e}))}function z(e){b.disabled||(k.value=C.value,V.touchStart(e),g&&g.closeOther?g.closeOther($):S($))}function M(e){if(b.disabled)return;if(V.touchMove(e),"vertical"===V.direction.value)return;e.preventDefault(),e.stopPropagation(),j.value=!0;const a=k.value+V.deltaX.value;Q().then(([t,l])=>0===t&&a>0||0===l&&a<0?(F(0),z(e)):0!==t&&a>=t?(F(t),z(e)):0!==l&&-a>=l?(F(-l),z(e)):void F(a))}function O(){if(b.disabled)return;const e=.3;j.value=!1,Q().then(([a,t])=>{k.value<0&&C.value<0&&C.value-k.value<t*e?(F(-t),x("update:modelValue","right")):k.value>0&&C.value>0&&k.value-C.value<a*e?(F(a),x("update:modelValue","left")):t>0&&k.value>=0&&C.value<0&&Math.abs(C.value)>t*e?(F(-t),x("update:modelValue","right")):a>0&&k.value<=0&&C.value>0&&Math.abs(C.value)>a*e?(F(a),x("update:modelValue","left")):P("swipe")})}function P(e,a){if("swipe"===e&&0===k.value)return F(0);"swipe"===e&&k.value>0?a="left":"swipe"===e&&k.value<0&&(a="right"),e&&a&&b.beforeClose&&b.beforeClose(e,a),F(0),"close"!==b.modelValue&&x("update:modelValue","close")}return s(()=>b.modelValue,(e,a)=>{T(e,a)},{deep:!0}),o(()=>{g&&g.pushToQueue?g.pushToQueue($):B($),k.value=0,C.value=0,j.value=!1}),u(()=>{j.value=!0,T(b.modelValue),j.value=!1}),i(()=>{g&&g.removeFromQueue?g.removeFromQueue($):G($)}),h({close:P}),(e,a)=>{const t=f;return r(),n(t,{class:_(`wd-swipe-action ${e.customClass}`),style:p(e.customStyle),onClick:a[2]||(a[2]=m(e=>I(),["stop"])),onTouchstart:z,onTouchmove:M,onTouchend:O,onTouchcancel:O},{default:c(()=>[d(t,{class:"wd-swipe-action__wrapper",style:p(y.value)},{default:c(()=>[d(t,{class:"wd-swipe-action__left",onClick:a[0]||(a[0]=e=>I("left"))},{default:c(()=>[v(e.$slots,"left",{},void 0,!0)]),_:3}),v(e.$slots,"default",{},void 0,!0),d(t,{class:"wd-swipe-action__right",onClick:a[1]||(a[1]=e=>I("right"))},{default:c(()=>[v(e.$slots,"right",{},void 0,!0)]),_:3})]),_:3},8,["style"])]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-ec0f42c7"]]),N=X(e({__name:"continuous-scan",setup(e){const a=t([]);function l(){I()}return h(()=>{w(z,e=>{a.value.includes(e)?b({title:"改码已存在，请勿重复扫描",icon:"none"}):a.value.push(e)})}),x(()=>{g(z)}),y(()=>{g(z)}),(e,t)=>{const s=k(C("wd-navbar"),O),o=f,u=k(C("wd-status-tip"),P),i=k(C("wd-swipe-action"),K),p=k(C("wd-button"),J),v=M;return r(),n(o,{class:"h-full flex flex-col overflow-hidden"},{default:c(()=>[d(s,{"left-arrow":"","safe-area-inset-top":"",title:"连续扫码示例",onClickLeft:l,class:"left-arrow safe-area-inset-top"}),0===j(a).length?(r(),n(o,{key:0,class:"flex flex-1 flex-col items-center justify-center"},{default:c(()=>[d(u,{image:"content",tip:"请扫描盒码"},{image:c(()=>[d(o,{class:"i-mdi_cl_qrcode-scan text-200 text-gray-4"})]),_:1})]),_:1})):(r(),n(o,{key:1,class:"flex flex-1 flex-col overflow-y-auto"},{default:c(()=>[(r(!0),V($,null,T(j(a),e=>(r(),n(i,{key:e},{right:c(()=>[d(o,{class:"h-full"},{default:c(()=>[d(o,{class:"h-full flex items-center justify-center bg-danger px-3 text-32 text-white",onClick:t=>function(e){a.value=a.value.filter(a=>a!==e)}(e)},{default:c(()=>[Q(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:c(()=>[d(o,{class:"mb-2rpx bg-white px-3 py-4 text-32 text-font-color-primary"},{default:c(()=>[Q(F(e),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})),d(o,{class:"form-actions"},{default:c(()=>[d(o,{class:"flex-1 text-font-color-primary"},{default:c(()=>[Q(" 已扫描："+F(j(a).length),1)]),_:1}),d(o,{class:"ml-auto"},{default:c(()=>[d(p,{round:!1,plain:"",size:"large",class:"_el_mr-3 _el_w-50 plain"},{default:c(()=>[Q(" 暂存 ")]),_:1}),d(p,{round:!1,size:"large",type:"primary",class:"_el_mr-0 _el_w-50"},{default:c(()=>[Q(" 提交 ")]),_:1})]),_:1})]),_:1}),d(v)]),_:1})}}}),[["__scopeId","data-v-dc342b30"]]);export{N as default};
