import{d as e,B as a,r as t,g as l,w as s,m as o,o as u,C as i,a as n,b as r,e as c,f as d,i as f,l as p,h as v,G as m,n as _,v as w,a5 as h,a1 as b,aa as x,ab as g,a6 as y,x as k,y as C,u as j,p as V,F as $,E as T,k as Q,t as z,I as F}from"./index-CEFtUz65.js";import{B as I,_ as M}from"./index.BYPA7Cvp.js";import{_ as q}from"./wd-navbar.DPZlLste.js";import{_ as B}from"./wd-status-tip.CsXv35t0.js";import{q as G,p as O,r as P,c as S}from"./useQueue.QfceSduj.js";import{u as D}from"./useTouch.CLIh5Sq0.js";import{c as E,a as H,b as L,g as N}from"./wd-icon.l0fM0rsZ.js";import{_ as X}from"./_plugin-vue_export-helper.BCo6x5W8.js";import{_ as A}from"./wd-button.DqYtjJhw.js";const J=X(e({name:"wd-swipe-action",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"},props:{...E,modelValue:L("close"),disabled:H(!1),beforeClose:Function},emits:["click","update:modelValue"],setup(e,{expose:w,emit:h}){const b=e,x=h,g=a(G,null),y=t(""),k=t(0),C=t(0),j=t(!1),V=D(),{proxy:$}=l();function T(e,a){b.disabled||Q().then(([t,l])=>{switch(e){case"close":if(0===C.value)return;B("value",a);break;case"left":z(t);break;case"right":z(-l)}})}function Q(){return Promise.all([N(".wd-swipe-action__left",!1,$).then(e=>e.width?e.width:0),N(".wd-swipe-action__right",!1,$).then(e=>e.width?e.width:0)])}function z(e=0){const a=`translate3d(${e}px, 0, 0)`,t=j.value?"none":".6s cubic-bezier(0.18, 0.89, 0.32, 1)";y.value=`\n        -webkit-transform: ${a};\n        -webkit-transition: ${t};\n        transform: ${a};\n        transition: ${t};\n      `,C.value=e}function F(e){b.disabled||0===C.value||(B("click",e=e||"inside"),x("click",{value:e}))}function I(e){b.disabled||(k.value=C.value,V.touchStart(e),g&&g.closeOther?g.closeOther($):S($))}function M(e){if(b.disabled)return;if(V.touchMove(e),"vertical"===V.direction.value)return;e.preventDefault(),e.stopPropagation(),j.value=!0;const a=k.value+V.deltaX.value;Q().then(([t,l])=>0===t&&a>0||0===l&&a<0?(z(0),I(e)):0!==t&&a>=t?(z(t),I(e)):0!==l&&-a>=l?(z(-l),I(e)):void z(a))}function q(){if(b.disabled)return;const e=.3;j.value=!1,Q().then(([a,t])=>{k.value<0&&C.value<0&&C.value-k.value<t*e?(z(-t),x("update:modelValue","right")):k.value>0&&C.value>0&&k.value-C.value<a*e?(z(a),x("update:modelValue","left")):t>0&&k.value>=0&&C.value<0&&Math.abs(C.value)>t*e?(z(-t),x("update:modelValue","right")):a>0&&k.value<=0&&C.value>0&&Math.abs(C.value)>a*e?(z(a),x("update:modelValue","left")):B("swipe")})}function B(e,a){if("swipe"===e&&0===k.value)return z(0);"swipe"===e&&k.value>0?a="left":"swipe"===e&&k.value<0&&(a="right"),e&&a&&b.beforeClose&&b.beforeClose(e,a),z(0),"close"!==b.modelValue&&x("update:modelValue","close")}return s(()=>b.modelValue,(e,a)=>{T(e,a)},{deep:!0}),o(()=>{g&&g.pushToQueue?g.pushToQueue($):O($),k.value=0,C.value=0,j.value=!1}),u(()=>{j.value=!0,T(b.modelValue),j.value=!1}),i(()=>{g&&g.removeFromQueue?g.removeFromQueue($):P($)}),w({close:B}),(e,a)=>{const t=f;return r(),n(t,{class:_(`wd-swipe-action ${e.customClass}`),style:p(e.customStyle),onClick:a[2]||(a[2]=m(e=>F(),["stop"])),onTouchstart:I,onTouchmove:M,onTouchend:q,onTouchcancel:q},{default:c(()=>[d(t,{class:"wd-swipe-action__wrapper",style:p(y.value)},{default:c(()=>[d(t,{class:"wd-swipe-action__left",onClick:a[0]||(a[0]=e=>F("left"))},{default:c(()=>[v(e.$slots,"left",{},void 0,!0)]),_:3}),v(e.$slots,"default",{},void 0,!0),d(t,{class:"wd-swipe-action__right",onClick:a[1]||(a[1]=e=>F("right"))},{default:c(()=>[v(e.$slots,"right",{},void 0,!0)]),_:3})]),_:3},8,["style"])]),_:3},8,["class","style"])}}}),[["__scopeId","data-v-ec0f42c7"]]),K=X(e({__name:"continuous-scan",setup(e){const a=t([]);function l(){F()}return w(()=>{h(I,e=>{a.value.includes(e)?b({title:"改码已存在，请勿重复扫描",icon:"none"}):a.value.push(e)})}),x(()=>{g(I)}),y(()=>{g(I)}),(e,t)=>{const s=k(C("wd-navbar"),q),o=f,u=k(C("wd-status-tip"),B),i=k(C("wd-swipe-action"),J),p=k(C("wd-button"),A),v=M;return r(),n(o,{class:"h-full flex flex-col overflow-hidden"},{default:c(()=>[d(s,{"left-arrow":"","safe-area-inset-top":"",title:"连续扫码示例",onClickLeft:l,class:"left-arrow safe-area-inset-top"}),0===j(a).length?(r(),n(o,{key:0,class:"flex flex-1 flex-col items-center justify-center"},{default:c(()=>[d(u,{image:"content",tip:"请扫描盒码"},{image:c(()=>[d(o,{class:"i-mdi_cl_qrcode-scan text-200 text-gray-4"})]),_:1})]),_:1})):(r(),n(o,{key:1,class:"flex flex-1 flex-col overflow-y-auto"},{default:c(()=>[(r(!0),V($,null,T(j(a),e=>(r(),n(i,{key:e},{right:c(()=>[d(o,{class:"h-full"},{default:c(()=>[d(o,{class:"h-full flex items-center justify-center bg-danger px-3 text-32 text-white",onClick:t=>function(e){a.value=a.value.filter(a=>a!==e)}(e)},{default:c(()=>[Q(" 删除 ")]),_:2},1032,["onClick"])]),_:2},1024)]),default:c(()=>[d(o,{class:"mb-2rpx bg-white px-3 py-4 text-32 text-font-color-primary"},{default:c(()=>[Q(z(e),1)]),_:2},1024)]),_:2},1024))),128))]),_:1})),d(o,{class:"form-actions"},{default:c(()=>[d(o,{class:"flex-1 text-font-color-primary"},{default:c(()=>[Q(" 已扫描："+z(j(a).length),1)]),_:1}),d(o,{class:"ml-auto"},{default:c(()=>[d(p,{round:!1,plain:"",size:"large",class:"_el_mr-3 _el_w-50 plain"},{default:c(()=>[Q(" 暂存 ")]),_:1}),d(p,{round:!1,size:"large",type:"primary",class:"_el_mr-0 _el_w-50"},{default:c(()=>[Q(" 提交 ")]),_:1})]),_:1})]),_:1}),d(v)]),_:1})}}}),[["__scopeId","data-v-dc342b30"]]);export{K as default};
