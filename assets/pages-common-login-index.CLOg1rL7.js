import{az as e,ae as a,at as r,r as s,a4 as t,aA as o,aB as l,av as d,d as n,H as u,s as m,aC as i,aD as c,a as p,e as w,i as f,x as b,y,b as v,f as x,Z as g,k as _,u as h,aE as j,aF as P,aG as k,ay as z,A as C}from"./index-CEFtUz65.js";import{_ as V}from"./wd-button.DqYtjJhw.js";import{_ as I}from"./wd-input.C264n9Kf.js";import{_ as U,t as B}from"./await-to-js.es5.BgQ1riPP.js";import{_ as T}from"./wd-checkbox.ZNBufW3G.js";import{_ as E}from"./login-bg.Bj4ZCXHv.js";import{_ as F}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./wd-icon.l0fM0rsZ.js";import"./types.CrUcA0sO.js";import"./useTranslate.DpgYe_aY.js";import"./wd-loading.DcA3_Ita.js";import"./wd-overlay.CMeC7-1k.js";import"./useChildren.CmGIXl1g.js";const q=r("user",()=>{const r=s({userId:"",username:"",avatar:""}),n=s(t()),u=s(o.get("rememberPwd"));return{loginByCode:async function(a){try{const s=await(r=a,e("/user/loginByCode",{data:r})),{accessToken:t}=s;if(t)return l(t),n.value=t,Promise.resolve()}catch(s){return Promise.reject(s)}var r},loginByPwd:async function(a){try{const s=await(r=a,e("/user/login",{data:r})),{accessToken:t}=s;return t?(l(t),n.value=t,"Y"===u.value?(o.set("rememberPwd",u.value),o.set("username",a.username),o.set("password",a.password)):(o.remove("rememberPwd"),o.remove("username"),o.remove("password")),Promise.resolve()):Promise.reject(new Error("登录失败"))}catch(s){return Promise.reject(s)}var r},logout:async function(){await e("/user/logout"),d(),n.value=""},getUserInfo:async function(e){try{const t=await(s=e,a("/user/profile",{params:s}));if(t)return r.value=t,Promise.resolve()}catch(t){return Promise.reject(t)}var s},userInfo:r,token:n,rememberPwd:u}}),A=F(n({__name:"index",setup(e){const a=q(),r=s(),t=u({username:o.get("username")||"",password:o.get("password")||""}),l=s(!1);let d=P;const n=async()=>{const{valid:e}=await r.value.validate();if(!e)return;l.value=!0;const[s]=await B(a.loginByPwd({username:t.username,password:t.password}));s?l.value=!1:setTimeout(()=>{j(d)?k({url:d}):z({url:d})},800)},F=e=>{C({url:`/pages/common/webview/index?url=https://www.baidu.com&title=${"user"===e?"用户协议":"隐私政策"}`})};return m(e=>{e.redirect&&i(e.redirect)!==c&&(d=decodeURIComponent(e.redirect))}),(e,s)=>{const o=g,d=f,u=b(y("wd-button"),V),m=b(y("wd-input"),I),i=b(y("wd-form"),U),c=b(y("wd-checkbox"),T);return v(),p(d,{class:"relative box-border h-screen bg-white"},{default:w(()=>[x(d,{class:"relative h-620rpx flex flex-col items-center leading-none"},{default:w(()=>[x(o,{src:E,class:"absolute left-0 top-0 z-1 h-full w-full"}),x(o,{src:"/uniapp-template/assets/logo-CpJe365G.png",mode:"scaleToFill",class:"relative z-2 mt-180rpx h-128 w-128"}),x(d,{class:"relative z-2 mt-4 text-52 text-font-color-primary font-bold"},{default:w(()=>[_(" 海维 Uniapp 开发模版 ")]),_:1})]),_:1}),x(d,{class:"relative z-2 box-border overflow-hidden border-rounded-t-5 py-6 -mt-12 _el_bg-white"},{default:w(()=>[x(d,{class:"flex items-center justify-between px-6"},{default:w(()=>[x(d,{class:"text-40 text-font-color-primary font-bold"},{default:w(()=>[_(" 用户登录 ")]),_:1}),x(u,{type:"text"},{default:w(()=>[_(" 软件设置 ")]),_:1})]),_:1}),x(i,{ref_key:"loginForm",ref:r,model:h(t),"error-type":"message",class:"mt-6 px-3"},{default:w(()=>[x(m,{modelValue:h(t).username,"onUpdate:modelValue":s[0]||(s[0]=e=>h(t).username=e),prop:"username","label-width":"120rpx",label:"用户名",type:"number",clearable:"",placeholder:"请输入用户名",class:"my-1 clearable",rules:[{required:!0,message:"请填写用户名"}]},null,8,["modelValue"]),x(d,{class:"mx-3 border-b-2 border-gray-1 border-b-solid"}),x(m,{modelValue:h(t).password,"onUpdate:modelValue":s[1]||(s[1]=e=>h(t).password=e),prop:"password","label-width":"120rpx",label:"密码",type:"text",clearable:"","show-password":"",placeholder:"请输入密码",class:"login-input my-1 clearable show-password",rules:[{required:!0,message:"请填写密码"}]},null,8,["modelValue"]),x(d,{class:"mx-3 border-b-2 border-gray-1 border-b-solid"})]),_:1},8,["model"]),x(u,{size:"large",round:!1,block:"",type:"primary",class:"mt-10 _el_mx-6 block",loading:h(l),onClick:n},{default:w(()=>[_(" 登 录 ")]),_:1},8,["loading"]),x(c,{modelValue:h(a).rememberPwd,"onUpdate:modelValue":s[2]||(s[2]=e=>h(a).rememberPwd=e),"true-value":"Y","false-value":"N",class:"ml-6 mt-5"},{default:w(()=>[_(" 记住密码 ")]),_:1},8,["modelValue"]),x(d,{class:"mt-10 flex items-center justify-center text-24rpx text-font-color-secondary"},{default:w(()=>[_(" 登录代表你已同意 "),x(u,{type:"text",size:"small",onClick:s[3]||(s[3]=e=>F("user"))},{default:w(()=>[_(" 《用户协议》 ")]),_:1}),_(" 和 "),x(u,{type:"text",size:"small",onClick:s[4]||(s[4]=e=>F("privacy"))},{default:w(()=>[_(" 《隐私政策》 ")]),_:1})]),_:1})]),_:1})]),_:1})}}}),[["__scopeId","data-v-706b7498"]]);export{A as default};
